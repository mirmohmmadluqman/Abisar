<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Abisar - Premium tech store with huge discounts in Srinagar, Jammu and Kashmir">
    <meta name="keywords" content="Abisar, tech store, Srinagar, smartphones, gaming laptops, drones, discounts">
    <meta property="og:title" content="Abisar - Premium Tech Store">
    <meta property="og:description" content="Shop premium tech at unbeatable prices in Srinagar, Jammu and Kashmir">
    <meta property="og:type" content="website">
    <title>Abisar - Premium Tech Store</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        body.dark-mode {
            background-color: #1a202c;
            color: #e2e8f0;
        }
        .header {
            background-color: #131921;
            color: white;
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 100;
            transition: opacity 0.3s ease;
        }
        .dark-mode .header {
            background-color: #2d3748;
        }
        .header-hidden {
            opacity: 0;
            pointer-events: none;
        }
        .product-card {
            background-color: white;
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .dark-mode .product-card {
            background-color: #2d3748;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .carousel-container {
            position: relative;
            width: 100%;
            overflow: hidden;
        }
        .carousel {
            display: flex;
            transition: transform 0.5s ease;
        }
        .carousel img {
            width: 100%;
            height: 200px;
            object-fit: contain;
            border-radius: 4px;
            flex: 0 0 100%;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        .carousel img:hover {
            transform: scale(1.1);
        }
        .carousel img.error {
            background: #f5f5f5;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #767676;
            font-size: 12px;
        }
        .dark-mode .carousel img.error {
            background: #4a5568;
            color: #cbd5e0;
        }
        .carousel-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 8px;
            cursor: pointer;
            border-radius: 50%;
            user-select: none;
            font-size: 14px;
        }
        .carousel-nav.left { left: 8px; }
        .carousel-nav.right { right: 8px; }
        .carousel-nav.hidden { display: none; }
        .original-price {
            text-decoration: line-through;
            color: #B12704;
            font-size: 0.9rem;
        }
        .discounted-price {
            color: #B12704;
            font-weight: 500;
        }
        .buy-button {
            background-color: #FFA41C;
            color: #111;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: background-color 0.2s ease;
            text-decoration: none;
        }
        .buy-button:hover {
            background-color: #F7CA00;
        }
        .star-rating {
            color: #FFA41C;
            font-size: 1rem;
        }
        #zoomModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        #zoomModal img {
            max-width: 90%;
            max-height: 90%;
            border-radius: 8px;
        }
        #backToTop {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #37475A;
            color: white;
            padding: 10px 15px;
            border-radius: 50%;
            display: none;
            cursor: pointer;
            z-index: 999;
        }
        #liveChat {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: #007185;
            color: white;
            padding: 10px 15px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 999;
        }
        #loadingSpinner {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 4px solid #f5f5f5;
            border-top: 4px solid #007185;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            z-index: 1000;
        }
        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }
        .footer {
            background-color: #232F3E;
            color: white;
            padding: 2rem;
            text-align: center;
        }
        .dark-mode .footer {
            background-color: #1a202c;
        }
        .footer a {
            color: #DDD;
            text-decoration: none;
        }
        .footer a:hover {
            text-decoration: underline;
        }
        .review-section {
            margin-top: 1rem;
            border-top: 1px solid #e2e8f0;
            padding-top: 1rem;
        }
        .dark-mode .review-section {
            border-color: #4a5568;
        }
        .review-input {
            margin-top: 0.5rem;
        }
        .autocomplete-suggestions {
            position: absolute;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            max-height: 200px;
            overflow-y: auto;
            width: 256px;
            z-index: 100;
        }
        .dark-mode .autocomplete-suggestions {
            background: #2d3748;
            border-color: #4a5568;
            color: #e2e8f0;
        }
        .autocomplete-suggestions div {
            padding: 0.5rem;
            cursor: pointer;
        }
        .autocomplete-suggestions div:hover {
            background: #edf2f7;
        }
        .dark-mode .autocomplete-suggestions div:hover {
            background: #4a5568;
        }
        .recently-viewed {
            margin-top: 2rem;
        }
        #darkModeToggle {
            background: #4a5568;
            color: white;
            padding: 0.5rem;
            border-radius: 4px;
            cursor: pointer;
        }
        @media (max-width: 640px) {
            .carousel img {
                height: 150px;
            }
            .product-card {
                padding: 0.75rem;
            }
            h3 {
                font-size: 1.1rem;
            }
            .autocomplete-suggestions {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header id="header" class="header flex items-center justify-between px-4">
        <h1 class="text-2xl font-bold">Abisar</h1>
        <div class="flex items-center space-x-4">
            <div class="relative">
                <input type="text" id="searchInput" placeholder="Search products..." class="p-2 rounded border border-gray-300 w-64" aria-label="Search products">
                <div id="autocompleteSuggestions" class="autocomplete-suggestions hidden"></div>
            </div>
            <select id="categoryFilter" class="p-2 rounded border border-gray-300" aria-label="Filter by category">
                <option value="">All Categories</option>
                <option value="Gaming Console">Gaming Console</option>
                <option value="Smartphone">Smartphone</option>
                <option value="Gaming Smartphone">Gaming Smartphone</option>
                <option value="Gaming Laptop">Gaming Laptop</option>
                <option value="Laptop">Laptop</option>
                <option value="Drone">Drone</option>
            </select>
            <button id="darkModeToggle" aria-label="Toggle dark mode">🌙</button>
        </div>
    </header>

    <!-- Products Section -->
    <section class="container mx-auto p-4">
        <h2 class="text-2xl font-bold mb-4">Our Products</h2>
        <div id="product-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"></div>
    </section>

    <!-- Recently Viewed Section -->
    <section class="container mx-auto p-4 recently-viewed">
        <h2 class="text-2xl font-bold mb-4">Recently Viewed</h2>
        <div id="recently-viewed-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"></div>
    </section>

    <!-- Contact Section -->
    <section class="bg-white p-6 text-center dark-mode:bg-gray-800">
        <h2 class="text-2xl font-bold mb-4">Get in Touch</h2>
        <p class="text-gray-600 mb-2 dark-mode:text-gray-300">Questions or ready to buy? Contact us now!</p>
        <p class="mb-2">Email: <a href="mailto:abisarstore@gmail.com" class="text-blue-600 hover:underline dark-mode:text-blue-400">abisarstore@gmail.com</a></p>
        <p class="mb-4">Address: Srinagar, Jammu and Kashmir, India</p>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <p>© 2025 Abisar. All rights reserved. | <a href="mailto:abisarstore@gmail.com">abisarstore@gmail.com</a> | Srinagar, Jammu and Kashmir, India</p>
    </footer>

    <!-- Zoom Modal -->
    <div id="zoomModal">
        <img id="zoomImageElement" src="" alt="Zoomed product image">
    </div>

    <!-- Back to Top Button -->
    <div id="backToTop" aria-label="Back to top">↑</div>

    <!-- Live Chat Button -->
    <a id="liveChat" href="mailto:abisarstore@gmail.com?subject=Live Chat Inquiry" aria-label="Live chat">💬</a>

    <!-- Loading Spinner -->
    <div id="loadingSpinner"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Product data
            const products = [
                {
                    id: 1,
                    name: "PS4 Ronaldo and Messi Edition",
                    description: "Limited edition PS4 with custom Ronaldo and Messi artwork (images show standard PS4 Slim), 500 GB storage, includes one controller, supports all major PS4 titles.",
                    originalPrice: "₹48,000",
                    discountedPrice: "₹15,000",
                    category: "Gaming Console",
                    rating: 4,
                    onlineImages: [
                        "https://media.gettyimages.com/id/458708938/photo/console-playstation-4-on-white-background.jpg",
                        "https://media.gettyimages.com/id/461168733/photo/playstation-4-games-gta-v-fifa14-minecraft-xxxl.jpg",
                        "https://media.gettyimages.com/id/458708936/photo/console-playstation-4-and-pad-dualshock-camera-on-white-background.jpg",
                        "https://media.gettyimages.com/id/586668950/photo/sony-playstation-4-home-video-game-console-and-dualshock-4-wireless-controller-taken-on-january.jpg"
                    ],
                    reviews: []
                },
                {
                    id: 2,
                    name: "iPhone 4",
                    description: "Classic iPhone 4, 8 GB storage, iOS 7, 3.5-inch Retina display, 5 MP camera, ideal for collectors or budget users.",
                    originalPrice: "₹2,500",
                    discountedPrice: "₹900",
                    category: "Smartphone",
                    rating: 3,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-4-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-4-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-4-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-4-4.jpg"
                    ],
                    reviews: []
                },
                {
                    id: 3,
                    name: "Nubia Red Magic 8S Pro 5G (Transformer Limited Edition)",
                    description: "Gaming phone with Snapdragon 8 Gen 2, 16 GB RAM, 512 GB storage, 6.8-inch AMOLED, 120 Hz, Transformer-themed design (images show standard Red Magic 8S Pro).",
                    originalPrice: "₹211,000",
                    discountedPrice: "₹40,000",
                    category: "Gaming Smartphone",
                    rating: 5,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-8s-pro-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-8s-pro-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-8s-pro-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-8s-pro-4.jpg"
                    ],
                    reviews: []
                },
                {
                    id: 4,
                    name: "Alienware M14 RX",
                    description: "Gaming laptop with Intel i7 3rd Gen, 24 GB RAM, 500 GB SSD, 14-inch 120 Hz, NVIDIA GTX, Windows 10 Home (images show generic gaming laptop).",
                    originalPrice: "₹72,000",
                    discountedPrice: "₹20,000",
                    category: "Gaming Laptop",
                    rating: 4,
                    onlineImages: [
                        "https://images.pexels.com/photos/2582937/pexels-photo-2582937.jpeg",
                        "https://images.pexels.com/photos/2582938/pexels-photo-2582938.jpeg",
                        "https://images.pexels.com/photos/3945659/pexels-photo-3945659.jpeg",
                        "https://images.pexels.com/photos/7876708/pexels-photo-7876708.jpeg"
                    ],
                    reviews: []
                },
                {
                    id: 5,
                    name: "Samsung Galaxy A12",
                    description: "Budget smartphone with 4 GB RAM, 64 GB storage, 6.5-inch PLS LCD, 48 MP quad-camera, 5000 mAh battery.",
                    originalPrice: "₹20,400",
                    discountedPrice: "₹8,000",
                    category: "Smartphone",
                    rating: 4,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/samsung/samsung-galaxy-a12-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/samsung/samsung-galaxy-a12-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/samsung/samsung-galaxy-a12-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/samsung/samsung-galaxy-a12-4.jpg"
                    ],
                    reviews: []
                },
                {
                    id: 6,
                    name: "Redmi A3",
                    description: "Budget smartphone, 4 GB RAM, 64 GB storage, 6.71-inch HD+, MediaTek Helio, 5000 mAh battery.",
                    originalPrice: "₹19,200",
                    discountedPrice: "₹6,000",
                    category: "Smartphone",
                    rating: 3,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/xiaomi/xiaomi-redmi-a3-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/xiaomi/xiaomi-redmi-a3-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/xiaomi/xiaomi-redmi-a3-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/xiaomi/xiaomi-redmi-a3-4.jpg"
                    ],
                    reviews: []
                },
                {
                    id: 7,
                    name: "ZTE Nubia Red Magic 4",
                    description: "Gaming phone with Snapdragon 855, 12 GB RAM, 256 GB storage, 6.65-inch AMOLED, 144 Hz (images show Red Magic 5G).",
                    originalPrice: "₹84,000",
                    discountedPrice: "₹30,000",
                    category: "Gaming Smartphone",
                    rating: 4,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-5g-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-5g-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-5g-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-5g-4.jpg"
                    ],
                    reviews: []
                },
                {
                    id: 8,
                    name: "ZTE Red Magic 7",
                    description: "Gaming phone with Snapdragon 8 Gen 1, 12 GB RAM, 256 GB storage, 6.8-inch AMOLED, 165 Hz (slight display crack, fully functional).",
                    originalPrice: "₹60,000",
                    discountedPrice: "₹25,000",
                    category: "Gaming Smartphone",
                    rating: 4,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-7-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-7-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-7-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-7-4.jpg"
                    ],
                    reviews: []
                },
                {
                    id: 9,
                    name: "HP Pavilion Gaming F15",
                    description: "Gaming laptop with Ryzen 5 5600H, GTX 1650 4 GB, 16 GB RAM, 256 GB NVMe SSD, 15.6-inch 144 Hz (images show generic gaming laptop).",
                    originalPrice: "₹120,000",
                    discountedPrice: "₹32,000",
                    category: "Gaming Laptop",
                    rating: 5,
                    onlineImages: [
                        "https://images.pexels.com/photos/2582937/pexels-photo-2582937.jpeg",
                        "https://images.pexels.com/photos/2582938/pexels-photo-2582938.jpeg",
                        "https://images.pexels.com/photos/3945659/pexels-photo-3945659.jpeg",
                        "https://images.pexels.com/photos/7876708/pexels-photo-7876708.jpeg"
                    ],
                    reviews: []
                },
                {
                    id: 10,
                    name: "iPhone 7",
                    description: "iPhone 7 with 128 GB storage, A10 Fusion, 4.7-inch Retina HD, 12 MP camera, iOS 15.",
                    originalPrice: "₹24,000",
                    discountedPrice: "₹9,000",
                    category: "Smartphone",
                    rating: 4,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-7-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-7-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-7-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-7-4.jpg"
                    ],
                    reviews: []
                },
                {
                    id: 11,
                    name: "Xiaomi Redmi Turbo 4 Pro (Harry Potter Limited Edition)",
                    description: "Harry Potter-themed smartphone with Snapdragon 8s Gen 4, 16 GB RAM, 512 GB storage, 6.83-inch OLED, 120 Hz, 50 MP camera (images show standard Redmi Turbo 4 Pro).",
                    originalPrice: "₹60,000",
                    discountedPrice: "₹28,000",
                    category: "Smartphone",
                    rating: 4,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/xiaomi/xiaomi-redmi-turbo-4-pro-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/xiaomi/xiaomi-redmi-turbo-4-pro-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/xiaomi/xiaomi-redmi-turbo-4-pro-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/xiaomi/xiaomi-redmi-turbo-4-pro-4.jpg"
                    ],
                    reviews: []
                },
                {
                    id: 12,
                    name: "ZTE Nubia Z70 Ultra 5G (Galaxy Edition)",
                    description: "Gaming smartphone with Snapdragon 8 Elite, 24 GB RAM, 1 TB storage, 6.85-inch OLED, 144Hz, 50MP triple camera, 6150 mAh battery (images show ZTE Nubia Z60 Ultra).",
                    originalPrice: "₹108,000",
                    discountedPrice: "₹55,000",
                    category: "Gaming Smartphone",
                    rating: 5,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-z60-ultra-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-z60-ultra-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-z60-ultra-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-z60-ultra-4.jpg"
                    ],
                    reviews: []
                },
                {
                    id: 13,
                    name: "SVE Evo 998 Macro Drone",
                    description: "Advanced drone with 4K Ultra HD top camera, 720p bottom camera, 15-minute flight time, GPS, 1 km range, ideal for aerial photography.",
                    originalPrice: "₹5,000",
                    discountedPrice: "₹3,000",
                    category: "Drone",
                    rating: 4,
                    onlineImages: [
                        "https://images.pexels.com/photos/442616/pexels-photo-442616.jpeg",
                        "https://images.pexels.com/photos/287496/pexels-photo-287496.jpeg",
                        "https://images.pexels.com/photos/306803/pexels-photo-306803.jpeg",
                        "https://images.pexels.com/photos/442578/pexels-photo-442578.jpeg"
                    ],
                    reviews: []
                },
                {
                    id: 14,
                    name: "iPhone X",
                    description: "iPhone X with 64 GB storage, A11 Bionic, 5.8-inch Super Retina, Face ID, dual 12 MP cameras, iOS 14.",
                    originalPrice: "₹48,000",
                    discountedPrice: "₹18,000",
                    category: "Smartphone",
                    rating: 4,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-x-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-x-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-x-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-x-4.jpg"
                    ],
                    reviews: []
                },
                {
                    id: 15,
                    name: "HP EliteBook G3",
                    description: "Business laptop with Intel Core i5, 8 GB RAM, 700 GB HDD + 240 GB SSD, 14-inch Full HD, Windows 10 Pro (images show generic laptops).",
                    originalPrice: "₹54,000",
                    discountedPrice: "₹20,000",
                    category: "Laptop",
                    rating: 4,
                    onlineImages: [
                        "https://images.pexels.com/photos/18105/pexels-photo.jpg",
                        "https://images.pexels.com/photos/7974/pexels-photo.jpg",
                        "https://images.pexels.com/photos/5775/pexels-photo-5775.jpeg",
                        "https://images.pexels.com/photos/69432/pexels-photo-69432.jpeg"
                    ],
                    reviews: []
                },
                {
                    id: 16,
                    name: "HP Pavilion x360",
                    description: "2-in-1 laptop with 512GB SSD, 16GB RAM, Intel i5 processor, ideal for work and entertainment.",
                    originalPrice: "₹80,800",
                    discountedPrice: "₹35,000",
                    category: "Laptop",
                    rating: 4,
                    onlineImages: [
                        "https://ssl-product-images.www8-hp.com/digmedialib/prodimg/lowres/c06621739.png",
                        "https://images.pexels.com/photos/18105/pexels-photo.jpg",
                        "https://images.pexels.com/photos/7974/pexels-photo.jpg",
                        "https://images.pexels.com/photos/69432/pexels-photo-69432.jpeg"
                    ],
                    reviews: []
                },
                {
                    id: 17,
                    name: "Lenovo ThinkPad P51",
                    description: "Workstation laptop with 16GB RAM, 512GB SSD, touch screen, NVIDIA Quadro M1200, perfect for professionals.",
                    originalPrice: "₹120,000",
                    discountedPrice: "₹35,000",
                    category: "Laptop",
                    rating: 5,
                    onlineImages: [
                        "https://www.lenovo.com/medias/lenovo-thinkpad-p-series-hero.png",
                        "https://images.pexels.com/photos/18105/pexels-photo.jpg",
                        "https://images.pexels.com/photos/7974/pexels-photo.jpg",
                        "https://images.pexels.com/photos/69432/pexels-photo-69432.jpeg"
                    ],
                    reviews: []
                }
            ];

            // DOM elements
            const productList = document.getElementById("product-list");
            const searchInput = document.getElementById("searchInput");
            const categoryFilter = document.getElementById("categoryFilter");
            const zoomModal = document.getElementById("zoomModal");
            const zoomImageElement = document.getElementById("zoomImageElement");
            const header = document.getElementById("header");
            const backToTop = document.getElementById("backToTop");
            const liveChat = document.getElementById("liveChat");
            const loadingSpinner = document.getElementById("loadingSpinner");
            const recentlyViewedList = document.getElementById("recently-viewed-list");
            const darkModeToggle = document.getElementById("darkModeToggle");
            const autocompleteSuggestions = document.getElementById("autocompleteSuggestions");

            // State variables
            let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
            let recentlyViewed = JSON.parse(localStorage.getItem('recentlyViewed')) || [];
            let lastScrollTop = 0;

            // Dark mode
            if (localStorage.getItem('darkMode') === 'enabled') {
                document.body.classList.add('dark-mode');
                darkModeToggle.textContent = '☀️';
            }
            darkModeToggle.addEventListener('click', () => {
                document.body.classList.toggle('dark-mode');
                const isDarkMode = document.body.classList.contains('dark-mode');
                darkModeToggle.textContent = isDarkMode ? '☀️' : '🌙';
                localStorage.setItem('darkMode', isDarkMode ? 'enabled' : 'disabled');
            });

            // Helper functions
            function renderStars(rating) {
                return '★'.repeat(rating) + '☆'.repeat(5 - rating);
            }

            function loadImage(imgElement, localSrc, onlineSrc, placeholderSrc) {
                imgElement.src = localSrc;
                imgElement.onerror = () => {
                    imgElement.src = onlineSrc;
                    imgElement.onerror = () => {
                        imgElement.src = placeholderSrc;
                        imgElement.classList.add('error');
                        imgElement.alt = 'Image Not Available';
                    };
                };
            }

            function renderProducts(filteredProducts) {
                loadingSpinner.style.display = 'block';
                productList.innerHTML = "";
                if (filteredProducts.length === 0) {
                    productList.innerHTML = '<p class="text-center text-gray-600 dark-mode:text-gray-300 col-span-full">No products found.</p>';
                    loadingSpinner.style.display = 'none';
                    return;
                }
                filteredProducts.forEach(product => {
                    const letters = ['A', 'B', 'C', 'D'];
                    const imageElements = letters.map((letter, idx) => {
                        const localPath = `elements/${product.id}${letter}.jpg`;
                        const onlinePath = product.onlineImages[idx] || "https://via.placeholder.com/200x200?text=Image+Not+Found";
                        const placeholderPath = "https://via.placeholder.com/200x200?text=Image+Not+Available";
                        return `<img src="${localPath}" alt="${product.name} image ${letter}" class="lazy" loading="lazy" data-online="${onlinePath}" data-placeholder="${placeholderPath}">`;
                    });
                    const productCard = document.createElement("div");
                    productCard.className = "product-card";
                    productCard.innerHTML = `
                        <div class="carousel-container">
                            <div class="carousel" id="carousel_${product.id}">
                                ${imageElements.join('')}
                            </div>
                            <div class="carousel-nav left hidden">←</div>
                            <div class="carousel-nav right">→</div>
                        </div>
                        <h3 class="text-lg font-medium mt-2 text-gray-900 dark-mode:text-gray-100 truncate">${product.name}</h3>
                        <p class="text-sm text-gray-600 dark-mode:text-gray-300 line-clamp-2">${product.description}</p>
                        <div class="flex items-center mt-2">
                            <span class="discounted-price text-lg">${product.discountedPrice}</span>
                            <span class="original-price ml-2">${product.originalPrice}</span>
                        </div>
                        <div class="star-rating mt-1">${renderStars(product.rating)}</div>
                        <div class="flex justify-between mt-3">
                            <button class="buy-button wishlist-btn" data-id="${product.id}" aria-label="${wishlist.includes(product.id) ? 'Remove from' : 'Add to'} wishlist">
                                ${wishlist.includes(product.id) ? 'Remove from Wishlist' : 'Add to Wishlist'}
                            </button>
                            <a href="mailto:abisarstore@gmail.com?subject=Purchase Inquiry for ${encodeURIComponent(product.name)}" class="buy-button">Buy Now</a>
                        </div>
                        <div class="review-section">
                            <h4 class="text-sm font-medium">Reviews</h4>
                            <div id="reviews_${product.id}">
                                ${product.reviews.length ? product.reviews.map(r => `<p class="text-sm">${renderStars(r.rating)} ${r.comment}</p>`).join('') : '<p class="text-sm text-gray-500">No reviews yet.</p>'}
                            </div>
                            <div class="review-input">
                                <input type="text" placeholder="Write a review..." class="p-1 border rounded w-full text-sm" data-id="${product.id}">
                                <select class="p-1 border rounded text-sm mt-1" data-id="${product.id}">
                                    <option value="5">5 Stars</option>
                                    <option value="4">4 Stars</option>
                                    <option value="3">3 Stars</option>
                                    <option value="2">2 Stars</option>
                                    <option value="1">1 Star</option>
                                </select>
                                <button class="buy-button text-sm mt-1" data-id="${product.id}">Submit Review</button>
                            </div>
                        </div>
                    `;
                    productList.appendChild(productCard);

                    // Load images with fallback
                    productCard.querySelectorAll('.carousel img').forEach(img => {
                        const localSrc = img.src;
                        const onlineSrc = img.dataset.online;
                        const placeholderSrc = img.dataset.placeholder;
                        loadImage(img, localSrc, onlineSrc, placeholderSrc);
                    });

                    // Add to recently viewed
                    if (!recentlyViewed.includes(product.id)) {
                        recentlyViewed.unshift(product.id);
                        recentlyViewed = recentlyViewed.slice(0, 4);
                        localStorage.setItem('recentlyViewed', JSON.stringify(recentlyViewed));
                        renderRecentlyViewed();
                    }

                    // Add event listeners for carousel navigation
                    const leftNav = productCard.querySelector('.carousel-nav.left');
                    const rightNav = productCard.querySelector('.carousel-nav.right');
                    if (leftNav && rightNav) {
                        leftNav.addEventListener('click', () => moveCarousel(product.id, -1));
                        rightNav.addEventListener('click', () => moveCarousel(product.id, 1));
                    }

                    // Review submission
                    const reviewButton = productCard.querySelector('.review-input button');
                    reviewButton.addEventListener('click', () => {
                        const input = productCard.querySelector('.review-input input');
                        const ratingSelect = productCard.querySelector('.review-input select');
                        const comment = input.value.trim();
                        const rating = parseInt(ratingSelect.value);
                        if (comment) {
                            product.reviews.push({ rating, comment });
                            renderProducts(products.filter(p => filteredProducts.some(fp => fp.id === p.id)));
                        }
                    });
                });
                initializeCarousels();
                initializeWishlist();
                loadingSpinner.style.display = 'none';
            }

            function renderRecentlyViewed() {
                recentlyViewedList.innerHTML = '';
                const viewedProducts = products.filter(p => recentlyViewed.includes(p.id));
                if (viewedProducts.length === 0) {
                    recentlyViewedList.innerHTML = '<p class="text-center text-gray-600 dark-mode:text-gray-300 col-span-full">No recently viewed products.</p>';
                    return;
                }
                viewedProducts.forEach(product => {
                    const letters = ['A'];
                    const imageElement = `
                        <img src="elements/${product.id}A.jpg" alt="${product.name} image A" class="lazy" loading="lazy" data-online="${product.onlineImages[0]}" data-placeholder="https://via.placeholder.com/200x200?text=Image+Not+Available">
                    `;
                    const productCard = document.createElement("div");
                    productCard.className = "product-card";
                    productCard.innerHTML = `
                        <div class="carousel-container">
                            <div class="carousel" id="carousel_${product.id}">
                                ${imageElement}
                            </div>
                        </div>
                        <h3 class="text-lg font-medium mt-2 text-gray-900 dark-mode:text-gray-100 truncate">${product.name}</h3>
                        <p class="text-sm text-gray-600 dark-mode:text-gray-300 line-clamp-2">${product.description}</p>
                        <div class="flex items-center mt-2">
                            <span class="discounted-price text-lg">${product.discountedPrice}</span>
                            <span class="original-price ml-2">${product.originalPrice}</span>
                        </div>
                    `;
                    recentlyViewedList.appendChild(productCard);
                    const img = productCard.querySelector('.carousel img');
                    loadImage(img, img.src, img.dataset.online, img.dataset.placeholder);
                });
            }

            function showZoomImage(imgElement) {
                zoomImageElement.src = imgElement.src;
                zoomImageElement.onerror = () => {
                    zoomImageElement.src = imgElement.dataset.online;
                    zoomImageElement.onerror = () => {
                        zoomImageElement.src = imgElement.dataset.placeholder;
                    };
                };
                zoomModal.style.display = 'flex';
            }

            function moveCarousel(carouselId, direction) {
                const carousel = document.getElementById(`carousel_${carouselId}`);
                if (!carousel) return;
                const images = carousel.querySelectorAll('img');
                let currentIndex = parseInt(carousel.dataset.index) || 0;
                currentIndex = (currentIndex + direction + images.length) % images.length;
                carousel.style.transform = `translateX(-${currentIndex * 100}%)`;
                carousel.dataset.index = currentIndex;
                const leftNav = carousel.parentElement.querySelector('.carousel-nav.left');
                const rightNav = carousel.parentElement.querySelector('.carousel-nav.right');
                leftNav.classList.toggle('hidden', currentIndex === 0);
                rightNav.classList.toggle('hidden', currentIndex === images.length - 1);
            }

            function initializeCarousels() {
                document.querySelectorAll('.carousel').forEach(carousel => {
                    const images = carousel.querySelectorAll('img');
                    if (images.length > 1) {
                        carousel.parentElement.querySelector('.carousel-nav.right').classList.remove('hidden');
                    }
                    carousel.dataset.index = 0;
                    images.forEach(img => {
                        img.addEventListener('click', () => showZoomImage(img));
                    });
                });
            }

            function initializeWishlist() {
                document.querySelectorAll('.wishlist-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const id = parseInt(btn.dataset.id);
                        if (wishlist.includes(id)) {
                            wishlist = wishlist.filter(item => item !== id);
                            btn.textContent = 'Add to Wishlist';
                        } else {
                            wishlist.push(id);
                            btn.textContent = 'Remove from Wishlist';
                        }
                        localStorage.setItem('wishlist', JSON.stringify(wishlist));
                    });
                });
            }

            function showAutocompleteSuggestions() {
                const searchTerm = searchInput.value.toLowerCase();
                autocompleteSuggestions.innerHTML = '';
                if (!searchTerm) {
                    autocompleteSuggestions.classList.add('hidden');
                    return;
                }
                const suggestions = products.filter(p => p.name.toLowerCase().includes(searchTerm)).slice(0, 5);
                if (suggestions.length === 0) {
                    autocompleteSuggestions.classList.add('hidden');
                    return;
                }
                suggestions.forEach(p => {
                    const div = document.createElement('div');
                    div.textContent = p.name;
                    div.addEventListener('click', () => {
                        searchInput.value = p.name;
                        autocompleteSuggestions.classList.add('hidden');
                        filterProducts();
                    });
                    autocompleteSuggestions.appendChild(div);
                });
                autocompleteSuggestions.classList.remove('hidden');
            }

            function filterProducts() {
                const searchTerm = searchInput.value.toLowerCase();
                const category = categoryFilter.value;
                const filtered = products.filter(product =>
                    (product.name.toLowerCase().includes(searchTerm) || product.description.toLowerCase().includes(searchTerm)) &&
                    (!category || product.category === category)
                );
                renderProducts(filtered);
            }

            // Event listeners
            searchInput.addEventListener('input', () => {
                showAutocompleteSuggestions();
                filterProducts();
            });
            searchInput.addEventListener('blur', () => {
                setTimeout(() => autocompleteSuggestions.classList.add('hidden'), 200);
            });
            categoryFilter.addEventListener('change', filterProducts);

            zoomModal.addEventListener('click', (e) => {
                if (e.target !== zoomImageElement) zoomModal.style.display = 'none';
            });

            window.addEventListener('scroll', () => {
                let currentScroll = window.pageYOffset || document.documentElement.scrollTop;
                if (currentScroll > lastScrollTop && currentScroll > 100) {
                    header.classList.add('header-hidden');
                } else {
                    header.classList.remove('header-hidden');
                }
                lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;
                backToTop.style.display = currentScroll > 300 ? 'block' : 'none';
            });

            backToTop.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });

            // Initial render
            renderProducts(products);
            renderRecentlyViewed();
        });
    </script>
</body>
</html>
