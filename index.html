<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Abisar - Premium tech store with huge discounts in Srinagar, Jammu and Kashmir">
    <meta name="keywords" content="Abisar, tech store, Srinagar, smartphones, gaming laptops, drones, discounts">
    <meta property="og:title" content="Abisar - Premium Tech Store">
    <meta property="og:description" content="Shop premium tech at unbeatable prices in Srinagar, Jammu and Kashmir">
    <meta property="og:type" content="website">
    <title>Abisar - Premium Tech Store</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            animation: pageLoad 0.5s ease forwards;
        }
        @keyframes pageLoad {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .header {
            background-color: #131921;
            color: white;
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 100;
            transition: opacity 0.3s ease;
        }
        .header-hidden {
            opacity: 0;
            pointer-events: none;
        }
        .product-card {
            background-color: white;
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .carousel-container {
            position: relative;
            width: 100%;
            overflow: hidden;
        }
        .carousel {
            display: flex;
            transition: transform 0.5s ease;
        }
        .carousel img {
            width: 100%;
            height: 200px;
            object-fit: contain;
            border-radius: 4px;
            flex: 0 0 100%;
            cursor: pointer;
        }
        .carousel img.error {
            background: #f5f5f5;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #767676;
            font-size: 12px;
        }
        .carousel-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 8px;
            cursor: pointer;
            border-radius: 50%;
            user-select: none;
            font-size: 14px;
        }
        .carousel-nav.left { left: 8px; }
        .carousel-nav.right { right: 8px; }
        .carousel-nav.hidden { display: none; }
        .original-price {
            text-decoration: line-through;
            color: #B12704;
            font-size: 0.9rem;
        }
        .discounted-price {
            color: #B12704;
            font-weight: 500;
        }
        .buy-button {
            background-color: #FFA41C;
            color: #111;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: background-color 0.2s ease;
        }
        .buy-button:hover {
            background-color: #F7CA00;
        }
        .star-rating {
            color: #FFA41C;
            font-size: 1rem;
        }
        #zoomModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        #zoomModal img {
            max-width: 90%;
            max-height: 90%;
            border-radius: 8px;
        }
        #contactModal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            z-index: 1000;
            max-width: 400px;
            width: 90%;
        }
        #backToTop {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #37475A;
            color: white;
            padding: 10px 15px;
            border-radius: 50%;
            display: none;
            cursor: pointer;
            z-index: 999;
        }
        #liveChat {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: #007185;
            color: white;
            padding: 10px 15px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 999;
        }
        #loadingSpinner {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 4px solid #f5f5f5;
            border-top: 4px solid #007185;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            z-index: 1000;
        }
        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }
        .footer {
            background-color: #232F3E;
            color: white;
            padding: 2rem;
            text-align: center;
        }
        .footer a {
            color: #DDD;
            text-decoration: none;
        }
        .footer a:hover {
            text-decoration: underline;
        }
        @media (max-width: 640px) {
            .carousel img {
                height: 150px;
            }
            .product-card {
                padding: 0.75rem;
            }
            h3 {
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header id="header" class="header flex items-center justify-between px-4">
        <h1 class="text-2xl font-bold">Abisar</h1>
        <div class="flex items-center space-x-4">
            <input type="text" id="searchInput" placeholder="Search products..." class="p-2 rounded border border-gray-300 w-64" aria-label="Search products">
            <select id="categoryFilter" class="p-2 rounded border border-gray-300" aria-label="Filter by category">
                <option value="">All Categories</option>
                <option value="Gaming Console">Gaming Console</option>
                <option value="Smartphone">Smartphone</option>
                <option value="Gaming Smartphone">Gaming Smartphone</option>
                <option value="Gaming Laptop">Gaming Laptop</option>
                <option value="Laptop">Laptop</option>
                <option value="Drone">Drone</option>
            </select>
        </div>
    </header>

    <!-- Products Section -->
    <section class="container mx-auto p-4">
        <h2 class="text-2xl font-bold mb-4">Our Products</h2>
        <div id="product-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"></div>
    </section>

    <!-- Contact Section -->
    <section class="bg-white p-6 text-center">
        <h2 class="text-2xl font-bold mb-4">Get in Touch</h2>
        <p class="text-gray-600 mb-2">Questions or ready to buy? Contact us now!</p>
        <p class="mb-2">Email: <a href="mailto:abisarstore@gmail.com" class="text-blue-600 hover:underline">abisarstore@gmail.com</a></p>
        <p class="mb-4">Address: Srinagar, Jammu and Kashmir, India</p>
        <button id="contactButton" class="buy-button">Contact to Buy</button>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <p>© 2025 Abisar. All rights reserved. | <a href="mailto:abisarstore@gmail.com">Contact Us</a></p>
    </footer>

    <!-- Zoom Modal -->
    <div id="zoomModal">
        <img id="zoomImageElement" src="" alt="Zoomed product image">
    </div>

    <!-- Contact Modal -->
    <div id="contactModal">
        <h3 class="text-xl font-bold mb-4">Contact Us</h3>
        <p class="text-gray-600 mb-4">Send us your inquiry, and we'll get back to you soon!</p>
        <input type="text" id="contactName" placeholder="Your Name" class="w-full p-2 mb-2 border rounded" aria-label="Your Name">
        <input type="email" id="contactEmail" placeholder="Your Email" class="w-full p-2 mb-2 border rounded" aria-label="Your Email">
        <textarea id="contactMessage" placeholder="Your Message" class="w-full p-2 mb-2 border rounded" rows="4" aria-label="Your Message"></textarea>
        <div class="flex justify-end space-x-2">
            <button id="contactCancel" class="buy-button bg-gray-300 hover:bg-gray-400">Cancel</button>
            <button id="contactSubmit" class="buy-button">Send</button>
        </div>
    </div>

    <!-- Back to Top Button -->
    <div id="backToTop" aria-label="Back to top">↑</div>

    <!-- Live Chat Button -->
    <a id="liveChat" href="mailto:abisarstore@gmail.com?subject=Live Chat Inquiry" aria-label="Live chat">💬</a>

    <!-- Loading Spinner -->
    <div id="loadingSpinner"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Intersection Observer polyfill
            if (!window.IntersectionObserver) {
                const script = document.createElement("script");
                script.src = "https://polyfill.io/v3/polyfill.min.js?features=IntersectionObserver";
                document.head.appendChild(script);
            }

            // Product data
            const products = [
                {
                    id: 1,
                    name: "PS4 Ronaldo and Messi Edition",
                    description: "Limited edition PS4 with custom Ronaldo and Messi artwork (images show standard PS4 Slim), 500 GB storage, perfect for gaming enthusiasts. Includes one controller and supports all major PS4 titles.",
                    originalPrice: "₹40,000",
                    discountedPrice: "₹15,000",
                    category: "Gaming Console",
                    rating: 4,
                    onlineImages: [
                        "https://images.unsplash.com/photo-1486401898001-1d7240a0d3c0",
                        "https://images.unsplash.com/photo-1477948879621-787e877d4366",
                        "https://images.unsplash.com/photo-1484589065579-248aad0d8b13",
                        "https://images.unsplash.com/photo-1511707171634-5f897ff02aa9"
                    ]
                },
                {
                    id: 2,
                    name: "iPhone 4",
                    description: "Classic iPhone 4 in good condition, 8 GB storage, iOS 7, ideal for collectors or budget users. Features a 3.5-inch Retina display and 5 MP camera.",
                    originalPrice: "₹2,000",
                    discountedPrice: "₹900",
                    category: "Smartphone",
                    rating: 3,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-4-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-4-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-4-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-4-4.jpg"
                    ]
                },
                {
                    id: 3,
                    name: "Nubia Red Magic 8S Pro 5G (Transformer Limited Edition)",
                    description: "High-performance gaming phone with Snapdragon 8 Gen 2, 16 GB RAM, 512 GB storage, 6.8-inch AMOLED display, 120 Hz refresh rate, and Transformer-themed design (images show standard Red Magic 8S Pro).",
                    originalPrice: "₹90,000",
                    discountedPrice: "₹35,000",
                    category: "Gaming Smartphone",
                    rating: 5,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-8s-pro-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-8s-pro-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-8s-pro-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-8s-pro-4.jpg"
                    ]
                },
                {
                    id: 4,
                    name: "Alienware M14 RX",
                    description: "Powerful gaming laptop with Intel i7 3rd Gen processor, 24 GB RAM, 500 GB SSD, 14-inch 120 Hz display, NVIDIA GTX graphics, and Windows 10 Home (images show generic gaming laptop).",
                    originalPrice: "₹60,000",
                    discountedPrice: "₹20,000",
                    category: "Gaming Laptop",
                    rating: 4,
                    onlineImages: [
                        "https://images.pexels.com/photos/2582937/pexels-photo-2582937.jpeg",
                        "https://images.pexels.com/photos/2582938/pexels-photo-2582938.jpeg",
                        "https://images.pexels.com/photos/3945659/pexels-photo-3945659.jpeg",
                        "https://images.pexels.com/photos/7876708/pexels-photo-7876708.jpeg"
                    ]
                },
                {
                    id: 5,
                    name: "Samsung A12",
                    description: "Reliable budget smartphone with 4 GB RAM, 64 GB storage, 6.5-inch PLS LCD, 48 MP quad-camera, and 5000 mAh battery. Perfect for everyday use.",
                    originalPrice: "₹17,000",
                    discountedPrice: "₹8,000",
                    category: "Smartphone",
                    rating: 4,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/samsung/samsung-galaxy-a12-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/samsung/samsung-galaxy-a12-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/samsung/samsung-galaxy-a12-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/samsung/samsung-galaxy-a12-4.jpg"
                    ]
                },
                {
                    id: 6,
                    name: "Redmi A3",
                    description: "Budget-friendly smartphone in excellent condition, 4 GB RAM, 64 GB storage, 6.71-inch HD+ display, MediaTek Helio processor, and 5000 mAh battery.",
                    originalPrice: "₹16,000",
                    discountedPrice: "₹6,000",
                    category: "Smartphone",
                    rating: 3,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/xiaomi/xiaomi-redmi-a3-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/xiaomi/xiaomi-redmi-a3-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/xiaomi/xiaomi-redmi-a3-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/xiaomi/xiaomi-redmi-a3-4.jpg"
                    ]
                },
                {
                    id: 7,
                    name: "ZTE Nubia Red Magic 4",
                    description: "Gaming phone with Android 13, Snapdragon 855, 12 GB RAM, 256 GB storage, 6.65-inch AMOLED display, and 144 Hz refresh rate. Ideal for mobile gamers (images show Red Magic 5G).",
                    originalPrice: "₹70,000",
                    discountedPrice: "₹30,000",
                    category: "Gaming Smartphone",
                    rating: 4,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-5g-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-5g-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-5g-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-5g-4.jpg"
                    ]
                },
                {
                    id: 8,
                    name: "ZTE Red Magic 7",
                    description: "Gaming phone with Snapdragon 8 Gen 1, 12 GB RAM, 256 GB storage, 6.8-inch AMOLED display with a 165 Hz refresh rate (slight crack on display, fully functional).",
                    originalPrice: "₹50,000",
                    discountedPrice: "₹25,000",
                    category: "Gaming Smartphone",
                    rating: 4,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-7-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-7-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-7-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-red-magic-7-4.jpg"
                    ]
                },
                {
                    id: 9,
                    name: "HP Pavilion Gaming F15",
                    description: "Gaming laptop with Ryzen 5 5600H, GTX 1650 4 GB GDDR6, 16 GB dual-channel RAM (3000 MHz), 256 GB NVMe SSD, and 15.6-inch 144 Hz display (images show generic gaming laptop).",
                    originalPrice: "₹1,00,000",
                    discountedPrice: "₹32,000",
                    category: "Gaming Laptop",
                    rating: 5,
                    onlineImages: [
                        "https://images.pexels.com/photos/2582937/pexels-photo-2582937.jpeg",
                        "https://images.pexels.com/photos/2582938/pexels-photo-2582938.jpeg",
                        "https://images.pexels.com/photos/3945659/pexels-photo-3945659.jpeg",
                        "https://images.pexels.com/photos/7876708/pexels-photo-7876708.jpeg"
                    ]
                },
                {
                    id: 10,
                    name: "iPhone 7",
                    description: "Sleek iPhone 7 with 128 GB storage, A10 Fusion chip, 4.7-inch Retina HD display, 12 MP camera, and iOS 15. Great for daily use.",
                    originalPrice: "₹20,000",
                    discountedPrice: "₹9,000",
                    category: "Smartphone",
                    rating: 4,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-7-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-7-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-7-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-7-4.jpg"
                    ]
                },
                {
                    id: 11,
                    name: "Xiaomi Redmi Turbo 4 Pro (Harry Potter Limited Edition)",
                    description: "Unique Harry Potter-themed smartphone with Snapdragon 7+ Gen 2, 12 GB RAM, 512 GB storage, 6.67-inch AMOLED display, 120 Hz refresh rate, and 50 MP camera (images show standard Redmi Turbo 3).",
                    originalPrice: "₹50,000",
                    discountedPrice: "₹28,000",
                    category: "Smartphone",
                    rating: 4,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/xiaomi/xiaomi-redmi-turbo-3-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/xiaomi/xiaomi-redmi-turbo-3-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/xiaomi/xiaomi-redmi-turbo-3-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/xiaomi/xiaomi-redmi-turbo-3-4.jpg"
                    ]
                },
                {
                    id: 12,
                    name: "ZTE Nubia Z70 Ultra 5G (Galaxy Edition)",
                    description: "Premium gaming smartphone with Snapdragon 8 Elite, 24 GB RAM, 1 TB storage, 6.85-inch OLED display with 144Hz refresh rate, 50MP triple camera with 35mm variable aperture, and 6150 mAh battery with 80W fast charging. Galaxy Edition features a unique starry finish (images show standard ZTE Nubia Z60 Ultra).",
                    originalPrice: "₹90,000",
                    discountedPrice: "₹55,000",
                    category: "Gaming Smartphone",
                    rating: 5,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-z60-ultra-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-z60-ultra-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-z60-ultra-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/zte/zte-nubia-z60-ultra-4.jpg"
                    ]
                },
                {
                    id: 13,
                    name: "SVE Evo 998 Macro Drone",
                    description: "Advanced drone with 4K Ultra HD top camera, 720p bottom camera, 15-minute flight time, GPS, and 1 km range. Perfect for aerial photography and videography (images show generic 4K drone).",
                    originalPrice: "₹30,000",
                    discountedPrice: "₹3,000",
                    category: "Drone",
                    rating: 4,
                    onlineImages: [
                        "https://images.pexels.com/photos/442587/pexels-photo-442587.jpeg",
                        "https://images.pexels.com/photos/442588/pexels-photo-442588.jpeg",
                        "https://images.pexels.com/photos/164678/pexels-photo-164678.jpeg",
                        "https://images.pexels.com/photos/306253/pexels-photo-306253.jpeg"
                    ]
                },
                {
                    id: 14,
                    name: "iPhone X",
                    description: "Revolutionary iPhone X with 64 GB storage, A11 Bionic chip, 5.8-inch Super Retina display, Face ID, and dual 12 MP cameras. Running iOS 14, perfect for modern use.",
                    originalPrice: "₹40,000",
                    discountedPrice: "₹18,000",
                    category: "Smartphone",
                    rating: 4,
                    onlineImages: [
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-x-1.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-x-2.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-x-3.jpg",
                        "https://fdn2.gsmarena.com/vv/pics/apple/apple-iphone-x-4.jpg"
                    ]
                },
                {
                    id: 15,
                    name: "HP EliteBook G3",
                    description: "Reliable business laptop with Intel Core i5, 8 GB RAM, 700 GB HDD + 240 GB SSD, 14-inch Full HD display, and Windows 10 Pro. Ideal for professionals and students (images show generic laptops).",
                    originalPrice: "₹45,000",
                    discountedPrice: "₹20,000",
                    category: "Laptop",
                    rating: 4,
                    onlineImages: [
                        "https://images.pexels.com/photos/18105/pexels-photo.jpg",
                        "https://images.pexels.com/photos/7974/pexels-photo.jpg",
                        "https://images.pexels.com/photos/5775/pexels-photo-5775.jpeg",
                        "https://images.pexels.com/photos/69432/pexels-photo-69432.jpeg"
                    ]
                }
            ];

            // DOM elements
            const productList = document.getElementById("product-list");
            const searchInput = document.getElementById("searchInput");
            const categoryFilter = document.getElementById("categoryFilter");
            const zoomModal = document.getElementById("zoomModal");
            const zoomImageElement = document.getElementById("zoomImageElement");
            const header = document.getElementById("header");
            const backToTop = document.getElementById("backToTop");
            const liveChat = document.getElementById("liveChat");
            const loadingSpinner = document.getElementById("loadingSpinner");
            const contactButton = document.getElementById("contactButton");
            const contactModal = document.getElementById("contactModal");
            const contactCancel = document.getElementById("contactCancel");
            const contactSubmit = document.getElementById("contactSubmit");

            // State variables
            let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
            let lastScrollTop = 0;

            // Helper functions
            function renderStars(rating) {
                return '★'.repeat(rating) + '☆'.repeat(5 - rating);
            }

            function renderProducts(filteredProducts) {
                loadingSpinner.style.display = 'block';
                productList.innerHTML = "";
                if (filteredProducts.length === 0) {
                    productList.innerHTML = '<p class="text-center text-gray-600 col-span-full">No products found.</p>';
                    loadingSpinner.style.display = 'none';
                    return;
                }
                filteredProducts.forEach(product => {
                    const letters = ['A', 'B', 'C', 'D'];
                    const imageElements = letters.map((letter, idx) => {
                        const localPath = `elements/${product.id}${letter}.png`;
                        const onlinePath = product.onlineImages[idx] || "https://via.placeholder.com/200x200?text=Image+Not+Found";
                        return `<img src="${localPath}" alt="${product.name} image ${letter}" class="lazy" loading="lazy" onerror="this.src='${onlinePath}'; this.classList.add('error');" onclick="showZoomImage('${localPath}', '${onlinePath}')">`;
                    });
                    const productCard = document.createElement("div");
                    productCard.className = "product-card";
                    productCard.innerHTML = `
                        <div class="carousel-container">
                            <div class="carousel" id="carousel_${product.id}">
                                ${imageElements.join('')}
                            </div>
                            <div class="carousel-nav left hidden" onclick="moveCarousel(${product.id}, -1)">←</div>
                            <div class="carousel-nav right" onclick="moveCarousel(${product.id}, 1)">→</div>
                        </div>
                        <h3 class="text-lg font-medium mt-2 text-gray-900 truncate">${product.name}</h3>
                        <p class="text-sm text-gray-600 line-clamp-2">${product.description}</p>
                        <div class="flex items-center mt-2">
                            <span class="discounted-price text-lg">${product.discountedPrice}</span>
                            <span class="original-price ml-2">${product.originalPrice}</span>
                        </div>
                        <div class="star-rating mt-1">${renderStars(product.rating)}</div>
                        <div class="flex justify-between mt-3">
                            <button class="buy-button wishlist-btn" data-id="${product.id}" aria-label="${wishlist.includes(product.id) ? 'Remove from' : 'Add to'} wishlist">
                                ${wishlist.includes(product.id) ? 'Remove from Wishlist' : 'Add to Wishlist'}
                            </button>
                            <button class="buy-button" onclick="openContactModal('${product.name}')">Buy Now</button>
                        </div>
                    `;
                    productList.appendChild(productCard);
                });
                initializeCarousels();
                initializeWishlist();
                loadingSpinner.style.display = 'none';
            }

            function showZoomImage(localSrc, onlineSrc) {
                zoomImageElement.src = localSrc;
                zoomImageElement.onerror = () => { zoomImageElement.src = onlineSrc; };
                zoomModal.style.display = 'flex';
            }

            function moveCarousel(carouselId, direction) {
                const carousel = document.getElementById(`carousel_${carouselId}`);
                if (!carousel) return;
                const images = carousel.querySelectorAll('img');
                let currentIndex = parseInt(carousel.dataset.index) || 0;
                currentIndex = (currentIndex + direction + images.length) % images.length;
                carousel.style.transform = `translateX(-${currentIndex * 100}%)`;
                carousel.dataset.index = currentIndex;
                const leftNav = carousel.parentElement.querySelector('.carousel-nav.left');
                const rightNav = carousel.parentElement.querySelector('.carousel-nav.right');
                leftNav.classList.toggle('hidden', currentIndex === 0);
                rightNav.classList.toggle('hidden', currentIndex === images.length - 1);
            }

            function initializeCarousels() {
                document.querySelectorAll('.carousel').forEach(carousel => {
                    const images = carousel.querySelectorAll('img');
                    if (images.length > 1) {
                        carousel.parentElement.querySelector('.carousel-nav.right').classList.remove('hidden');
                    }
                    carousel.dataset.index = 0;
                });
            }

            function initializeWishlist() {
                document.querySelectorAll('.wishlist-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const id = parseInt(btn.dataset.id);
                        if (wishlist.includes(id)) {
                            wishlist = wishlist.filter(item => item !== id);
                            btn.textContent = 'Add to Wishlist';
                        } else {
                            wishlist.push(id);
                            btn.textContent = 'Remove from Wishlist';
                        }
                        localStorage.setItem('wishlist', JSON.stringify(wishlist));
                    });
                });
            }

            function filterProducts() {
                const searchTerm = searchInput.value.toLowerCase();
                const category = categoryFilter.value;
                const filtered = products.filter(product =>
                    (product.name.toLowerCase().includes(searchTerm) || product.description.toLowerCase().includes(searchTerm)) &&
                    (!category || product.category === category)
                );
                renderProducts(filtered);
            }

            function openContactModal(productName = '') {
                if (productName) {
                    document.getElementById('contactMessage').value = `Interested in purchasing: ${productName}`;
                }
                contactModal.style.display = 'block';
            }

            // Event listeners
            searchInput.addEventListener('input', filterProducts);
            categoryFilter.addEventListener('change', filterProducts);

            zoomModal.addEventListener('click', (e) => {
                if (e.target !== zoomImageElement) zoomModal.style.display = 'none';
            });

            contactButton.addEventListener('click', () => openContactModal());

            contactCancel.addEventListener('click', () => {
                contactModal.style.display = 'none';
                document.getElementById('contactName').value = '';
                document.getElementById('contactEmail').value = '';
                document.getElementById('contactMessage').value = '';
            });

            contactSubmit.addEventListener('click', () => {
                const name = document.getElementById('contactName').value;
                const email = document.getElementById('contactEmail').value;
                const message = document.getElementById('contactMessage').value;
                if (name && email && message) {
                    const subject = encodeURIComponent('Purchase Inquiry');
                    const body = encodeURIComponent(`Name: ${name}\nEmail: ${email}\nMessage: ${message}`);
                    window.location.href = `mailto:abisarstore@gmail.com?subject=${subject}&body=${body}`;
                    contactModal.style.display = 'none';
                    document.getElementById('contactName').value = '';
                    document.getElementById('contactEmail').value = '';
                    document.getElementById('contactMessage').value = '';
                } else {
                    alert('Please fill in all fields.');
                }
            });

            window.addEventListener('scroll', () => {
                let currentScroll = window.pageYOffset || document.documentElement.scrollTop;
                if (currentScroll > lastScrollTop && currentScroll > 100) {
                    header.classList.add('header-hidden');
                } else {
                    header.classList.remove('header-hidden');
                }
                lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;
                backToTop.style.display = currentScroll > 300 ? 'block' : 'none';
            });

            backToTop.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });

            // Initial render
            renderProducts(products);
        });
    </script>
</body>
</html>
